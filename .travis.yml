language: generic
services:
  - docker
dist: bionic

jobs:
  include:
    - stage: test-unit
      before_install:
        - sudo apt-get update
        - sudo apt install --yes python
        - sudo apt install --yes python3.6
        - sudo apt install --yes python3.8
        - sudo apt install python-pip
      install: pip install tox
      script: tox
    - stage: test-integration
      before_install:
        - sudo pip3 install docker-compose
        - sudo pip3 install requirements-dev.txt
      script:
        - make test_integration
